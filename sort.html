<!DOCTYPE html>
<html>
<title>sorter</title>
<meta name="viewport" content="width=device-width" >
<link rel="stylesheet" href="./jqm/jquery.mobile.css" />
<script type="text/javascript" src="./jquery.js"></script>
<script type="text/javascript" src="./jqm/jquery.mobile.js"></script>
<body>
<div id="preContent"></div>
<script type="text/javascript">
<!--
var link=location.search.substr(1);
var decLink=decodeURIComponent(link);
  //alert(decLink);
  var mode=decLink.split(',')[0];
  var upDown=decLink.split(',')[1];
  var inText=decLink.split(',')[2].split('\n');
  
  //alert('mode='+ mode +'\nupDown='+ upDown +'\ninText='+ inText);

//function sorter(e){
  
  switch(mode){
    case 'num':
      if (upDown == 'up') {
        inText.sort(function(a, b){
          return a-b;
        });
      } else {
        inText.sort(function(a, b){
          return b-a;
        });
      }
      break;
      
    case 'date':
      if (inText[0].indexOf('/') > 0){
        var sep='/';
      } else if (inText[0].indexOf('-') > 0){
        var sep='-';
      }
      for (i=0;i<inText.length;i++){
        var dates=inText[i].split(sep);
        var datesLength=dates.length;
        for (j=datesLength-2;j<datesLength;j++){
          if (dates[j] < 10) {
            dates[j]='0'+dates[j];
          }
        }
        inText[i]='';
        for (j=0;j<datesLength;j++){
          if (j != datesLength-1){
            inText[i]+=dates[j]+sep;
          } else {
            inText[i]+=dates[j];
          }
        }
      }
      if (upDown == 'up') {
        inText.sort();
      } else {
        inText.sort();
        var tmp=[];
        for (i=0;i<inText.length;i++){
          tmp[i]=inText[i];
        }
        for (i=0;i<tmp.length;i++){
          inText[i]=tmp[tmp.length-1-i];
        }
      }
      break;
    
    case 'alph':
      if (upDown == 'up') {
        inText.sort(function(a, b){
          a = a.toString().toLowerCase();
          b = b.toString().toLowerCase();
        if(a < b){
          return -1;
        }else if(a > b){
          return 1;
        }
        return 0;
        });
      } else {
        inText.sort(function(a, b){
          a = a.toString().toLowerCase();
          b = b.toString().toLowerCase();
        if(a > b){
          return -1;
        }else if(a > b){
          return 1;
        }
        return 0;
        });
      }
      break;
      
    case 'kana':
      if (upDown == 'up') {
        inText.sort(function(a, b){
    a = katakanaToHiragana(a.toString());
    b = katakanaToHiragana(b.toString());
        if(a < b){
          return -1;
        }else if(a > b){
          return 1;
        }
        return 0;
        });
      } else {
        inText.sort(function(a, b){
    a = katakanaToHiragana(a.toString());
    b = katakanaToHiragana(b.toString());
        if(a > b){
          return -1;
        }else if(a > b){
          return 1;
        }
        return 0;
        });
      }
        
function katakanaToHiragana(src) {
    return src.replace(/[\u30a1-\u30f6]/g, function(match) {
        var chr = match.charCodeAt(0) - 0x60;
        return String.fromCharCode(chr);
    });
}
      break;
      
    case 'none':
      if (upDown == 'up') {
        inText.sort();
      } else {
        inText.sort();
        var tmp=[];
        for (i=0;i<inText.length;i++){
          tmp[i]=inText[i];
        }
        for (i=0;i<tmp.length;i++){
          inText[i]=tmp[tmp.length-1-i];
        }
      }
      break;
  }
//}

var result=inText.join('<br>');
  
var el=document.getElementById('preContent');
el.innerHTML=result;
  
// -->
</script>
</body>
</html>
